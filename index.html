<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tu Sonido Interior - Descubre tu Personalidad Musical</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        /* ... (otros estilos existentes se mantienen igual) ... */

        /* Nuevos estilos para el contador */
        .countdown-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            color: white;
        }
        
        .countdown-number {
            font-size: 8rem;
            font-weight: bold;
            margin-bottom: 2rem;
            animation: pulse 1s infinite;
        }
        
        .countdown-text {
            font-size: 1.5rem;
            text-align: center;
            max-width: 300px;
        }
        
        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fbbf24;
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .zoom-in {
            animation: zoomIn 0.5s forwards;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- ... (todo el contenido HTML anterior se mantiene igual hasta el botón de revelar) ... -->

        <!-- Reveal Button -->
        <div id="revealSection" class="text-center mb-8 hidden">
            <button id="revealButton" class="reveal-button" disabled>
                <i class="fas fa-magic mr-2"></i>Revelar Mi Perfil Musical
            </button>
        </div>

        <!-- Countdown Overlay (nuevo elemento) -->
        <div id="countdownOverlay" class="countdown-overlay hidden">
            <div class="loading-spinner"></div>
            <div id="countdownNumber" class="countdown-number">5</div>
            <div class="countdown-text">Analizando tu combinación única...</div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <!-- ... (contenido de resultados se mantiene igual) ... -->
        </div>

    </div>

    <script>
        // ... (todo el código JavaScript anterior se mantiene igual hasta la función revealProfile) ...

        function revealProfile() {
            // Mostrar overlay de cuenta regresiva
            const countdownOverlay = document.getElementById('countdownOverlay');
            countdownOverlay.classList.remove('hidden');
            
            let countdown = 5;
            const countdownNumber = document.getElementById('countdownNumber');
            countdownNumber.textContent = countdown;
            
            // Efecto de sonido para el conteo (opcional)
            const tickSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3');
            tickSound.volume = 0.3;
            
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownNumber.textContent = countdown;
                tickSound.play().catch(e => console.log("No se pudo reproducir sonido"));
                
                // Efecto visual para cada número
                countdownNumber.classList.remove('zoom-in');
                void countdownNumber.offsetWidth; // Trigger reflow
                countdownNumber.classList.add('zoom-in');
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    countdownOverlay.classList.add('hidden');
                    showProfileResults();
                }
            }, 1000);
        }

        function showProfileResults() {
            const profile = findProfile(gameState.color, gameState.melody, gameState.rhythm, gameState.emotion);
            
            if (profile) {
                displayProfile(profile);
            } else {
                displayDefaultProfile();
            }
            
            // Efecto de revelación con sonido
            const revealSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3');
            revealSound.play().catch(e => console.log("No se pudo reproducir sonido"));
            
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('resultsSection').classList.add('fade-in');
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        // ... (el resto del código JavaScript se mantiene igual) ...
    </script>
</body>
</html>
